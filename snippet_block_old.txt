  if (btn){
    // Prefer Ext handler call first to avoid focus/selection toggling
    await inFrames(async (ctx)=>{
      try {
        await ctx.evaluate((text) => {
          try {
            if (window.Ext){
              const tryClick = (cmp) => {
                if (!cmp) return;
                try { cmp.setDisabled && cmp.setDisabled(false); } catch(e){}
                try { cmp.focus && cmp.focus(); } catch(e){}
                try { cmp.fireEvent && cmp.fireEvent('click'); } catch(e){}
                try { cmp.handler && cmp.handler.call(cmp); } catch(e){}
              };
              let targetCmp = null;
              if (Ext.ComponentQuery){
                let arr = Ext.ComponentQuery.query('toolbar[dock="bottom"] button');
                if (arr && arr.length){
                  for (let i=0;i<arr.length;i++){
                    const candidate = arr[i];
                    const label = (candidate && (candidate.text || candidate.ariaLabel || (candidate.el && candidate.el.dom && candidate.el.dom.textContent))) || '';
                    if (label && label.indexOf(text) > -1) { targetCmp = candidate; break; }
                  }
                }
                if (!targetCmp){
                  arr = Ext.ComponentQuery.query('button');
                  if (arr && arr.length){
                    for (let j=0;j<arr.length;j++){
                      const candidate = arr[j];
                      const label = (candidate && (candidate.text || candidate.ariaLabel || (candidate.el && candidate.el.dom && candidate.el.dom.textContent))) || '';
                      if (label && label.indexOf(text) > -1) { targetCmp = candidate; break; }
                    }
                  }
                }
              }
              if (!targetCmp && Ext.ComponentManager && Ext.ComponentManager.each){
                Ext.ComponentManager.each(function(item){
                  if (targetCmp) return;
                  try {
                    const label = (item && (item.text || item.ariaLabel || (item.el && item.el.dom && item.el.dom.textContent))) || '';
                    if (label && label.indexOf(text) > -1) { targetCmp = item; }
                  } catch(e){}
                });
              }
              tryClick(targetCmp);
            }
          } catch(e){}
        }, APPLY_BUTTON_TEXT);
      } catch {}
      return false;
    });


