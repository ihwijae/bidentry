  if (btn){
    // Prefer Ext handler call first to avoid focus/selection toggling
    await inFrames(async (ctx)=>{
      try {
        await ctx.evaluate((text) => {
          try {
            if (window.Ext){
              const tryClick = (cmp) => {
                if (!cmp) return;
                try { cmp.setDisabled && cmp.setDisabled(false); } catch(e){}
                try { cmp.focus && cmp.focus(); } catch(e){}
                try { cmp.fireEvent && cmp.fireEvent('click'); } catch(e){}
                try { cmp.handler && cmp.handler.call(cmp); } catch(e){}
              };
              let targetCmp = null;
              if (Ext.ComponentQuery){
                let arr = Ext.ComponentQuery.query('toolbar[dock="bottom"] button');
                if (arr && ar
