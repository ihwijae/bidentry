# 한전 참가신청 작업 메모

## 현재 파악한 자동화 흐름
- `automation-engine/src/core/orchestrator.js`에서 한전 사이트는 로그인 이후 `goToBidApplyAndSearch → applyAfterSearch → handleFinalAgreementAndSubmit` 순으로 공고 검색과 참가신청을 진행합니다.
- `goToBidApplyAndSearch(page, emit, bidId)`는 검색 화면에 있는 공고번호 입력창·조회 버튼을 프레임 전체에서 탐색해 값을 채우고, 조회가 완료될 때까지 그리드 로딩 상태를 감시합니다.
- `applyAfterSearch(page, emit)`는 조회된 그리드에서 체크박스를 선택하고 하단 `입찰참가신청` 버튼을 클릭해 신청 모달을 띄웁니다. ExtJS 스토어/컴포넌트를 직접 만져 selection을 강제로 만드는 로직과 좌표 클릭 등 다양한 차선책이 포함돼 있습니다.
- 모달 이후에는 `handleFinalAgreementAndSubmit`가 안내 팝업을 닫고, 동의 체크박스를 텍스트 패턴으로 찾아 자동으로 체크한 뒤 최종 `제출` 버튼을 누릅니다. 실패 시 HTML 덤프를 남겨 상태 확인이 가능합니다.
- 메뉴 이동을 담당하는 `navigateToApplication(page, emit)`는 상단 `입찰/계약` 버튼과 좌측 트리의 `입찰참가신청` 노드를 정규화된 셀렉터로 탐색하는 신버전이지만 아직 오케스트레이터에서 호출되지 않고 있습니다. 신고전 로직(`goToBidApplyAndSearch`)은 문자열 깨짐 때문에 좌측 트리를 정확히 조작하지 못하는 상태입니다.

## 로그인 입력 개선 내용
- 로그인 모달에서 ID/PW 입력 필드를 찾을 때, 모든 DOM을 순회하느라 딜레이가 컸습니다. `#username`/`#password`와 같은 확정된 셀렉터를 최우선으로 사용하도록 `loginFieldConfig`를 보강했습니다.
- 값 입력은 더 이상 `type()`에 의존하지 않고, DOM 속성에 바로 값을 지정한 뒤 `input`/`change` 이벤트만 발행합니다. 필요시 `fill()`/`type()`을 지연 2ms로 보조하기 때문에 키 입력 속도 변동이 사라졌습니다.
- 이 변경으로 로그인 필드 탐색·입력이 팝업 상태에 크게 영향받지 않고 거의 즉시 처리되며, 엔진 로그에는 기존과 동일하게 `[KEPCO] ID/PW 로그인 시도 완료`만 남습니다.

## 다음 단계 아이디어
1. `navigateToApplication()`을 오케스트레이터에 연결하거나 `goToBidApplyAndSearch`와 병합해 메뉴 이동 단계가 안정적으로 수행되도록 합니다.
2. 참가신청 모달 이후 남아 있는 필수 입력(첨부/인증서 재확인 등)을 파악한 뒤, `handleFinalAgreementAndSubmit` 앞에서 훅을 추가하는지 여부를 결정합니다.
